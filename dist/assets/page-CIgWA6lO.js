import{r as m,j as e,C as c,g as o,o as F,a2 as I,y as V,a as w,d as C,af as i,ag as g,E as p,H as v,I as f,J as N,K as r,aU as $,B as S,p as M,aN as O,aV as q,m as H,f as h,b3 as k,D as J,v as U,w as Z,x as z,aR as W}from"./index-D2dOrPZ8.js";import{T as D}from"./triangle-alert-Cjhkzg0C.js";import{F as G}from"./funnel-D8IEwOH8.js";import{B as K}from"./building-BsNnMwoW.js";import{E as X}from"./external-link-CC_JdT4J.js";import{M as Y}from"./message-square-Bm6iE3sR.js";function re(){const[t,d]=m.useState({date_range:{start:new Date(Date.now()-2592e6).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]},type:"all",status:"all",overdue_range:"all",search:""}),[n,P]=m.useState(null),[L,x]=m.useState(!1),[j,_]=m.useState(""),u={total_pending:45,total_overdue:23,total_amount_pending:125e3,total_amount_overdue:67500},y=[{id:"INV-001",client_id:"client-1",client_name:"João Silva",client_email:"joao@empresa.com",client_phone:"(11) 99999-9999",client_company:"Empresa ABC Ltda",type:"project",amount:5e3,due_date:"2024-01-15",created_at:"2024-01-01T10:00:00Z",status:"overdue",overdue_days:15,description:"Projeto de desenvolvimento web",reference_id:"PROJ-123",checkout_url:"https://checkout.example.com/inv-001"},{id:"INV-002",client_id:"client-2",client_name:"Maria Santos",client_email:"maria@startup.com",client_phone:"(11) 88888-8888",client_company:"Startup XYZ",type:"credit_plan",amount:2500,due_date:"2024-01-20",created_at:"2024-01-05T14:30:00Z",status:"overdue",overdue_days:8,description:"Plano de créditos Premium",reference_id:"PLAN-456",checkout_url:"https://checkout.example.com/inv-002"}],b=m.useMemo(()=>y.filter(s=>{const a=new Date(s.created_at),R=new Date(t.date_range.start),A=new Date(t.date_range.end);if(a<R||a>A||t.type!=="all"&&s.type!==t.type||t.status!=="all"&&s.status!==t.status)return!1;if(t.overdue_range!=="all"){const l=s.overdue_days;switch(t.overdue_range){case"0-30":if(l<0||l>30)return!1;break;case"31-60":if(l<31||l>60)return!1;break;case"61-90":if(l<61||l>90)return!1;break;case"90+":if(l<90)return!1;break}}if(t.search){const l=t.search.toLowerCase();return s.client_name.toLowerCase().includes(l)||s.client_email.toLowerCase().includes(l)||s.client_company?.toLowerCase().includes(l)||s.id.toLowerCase().includes(l)}return!0}),[y,t]),T=(s,a)=>s==="overdue"?a>90?{variant:"destructive",label:"90+ dias"}:a>60?{variant:"destructive",label:"61-90 dias"}:a>30?{variant:"secondary",label:"31-60 dias"}:{variant:"outline",label:`${a} dias`}:{variant:"default",label:"Pendente"},B=s=>({project:"Projeto",credit_plan:"Plano de Crédito",post_paid:"Pós-pago"})[s]||s,E=s=>{P(s),_(`Olá ${s.client_name},

Sua fatura no valor de R$ ${s.amount.toLocaleString("pt-BR",{minimumFractionDigits:2})} está em aberto.

Clique no link abaixo para efetuar o pagamento:
${s.checkout_url}

Atenciosamente,
Equipe Allka`),x(!0)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Inadimplência"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Gerencie faturas em aberto e ações de cobrança"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(c,{children:e.jsx(o,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Pendente"}),e.jsx("p",{className:"text-2xl font-bold",children:u.total_pending}),e.jsx("p",{className:"text-sm text-gray-500",children:"faturas"})]}),e.jsx(F,{className:"h-8 w-8 text-blue-500"})]})})}),e.jsx(c,{children:e.jsx(o,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Em Atraso"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:u.total_overdue}),e.jsx("p",{className:"text-sm text-gray-500",children:"faturas"})]}),e.jsx(D,{className:"h-8 w-8 text-red-500"})]})})}),e.jsx(c,{children:e.jsx(o,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Valor Pendente"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:["R$ ",u.total_amount_pending.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),e.jsx("p",{className:"text-sm text-gray-500",children:"total"})]}),e.jsx(I,{className:"h-8 w-8 text-blue-500"})]})})}),e.jsx(c,{children:e.jsx(o,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Valor em Atraso"}),e.jsxs("p",{className:"text-2xl font-bold text-red-600",children:["R$ ",u.total_amount_overdue.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),e.jsx("p",{className:"text-sm text-gray-500",children:"total"})]}),e.jsx(V,{className:"h-8 w-8 text-red-500"})]})})})]}),e.jsxs(c,{children:[e.jsx(w,{children:e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-5 w-5"}),"Filtros"]})}),e.jsx(o,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Data Início"}),e.jsx(g,{type:"date",value:t.date_range.start,onChange:s=>d(a=>({...a,date_range:{...a.date_range,start:s.target.value}}))})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Data Fim"}),e.jsx(g,{type:"date",value:t.date_range.end,onChange:s=>d(a=>({...a,date_range:{...a.date_range,end:s.target.value}}))})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Tipo"}),e.jsxs(p,{value:t.type,onValueChange:s=>d(a=>({...a,type:s})),children:[e.jsx(v,{children:e.jsx(f,{})}),e.jsxs(N,{children:[e.jsx(r,{value:"all",children:"Todos"}),e.jsx(r,{value:"project",children:"Projetos"}),e.jsx(r,{value:"credit_plan",children:"Planos de Crédito"}),e.jsx(r,{value:"post_paid",children:"Pós-pago"})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Status"}),e.jsxs(p,{value:t.status,onValueChange:s=>d(a=>({...a,status:s})),children:[e.jsx(v,{children:e.jsx(f,{})}),e.jsxs(N,{children:[e.jsx(r,{value:"all",children:"Todos"}),e.jsx(r,{value:"pending",children:"Pendente"}),e.jsx(r,{value:"overdue",children:"Em Atraso"})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Dias de Atraso"}),e.jsxs(p,{value:t.overdue_range,onValueChange:s=>d(a=>({...a,overdue_range:s})),children:[e.jsx(v,{children:e.jsx(f,{})}),e.jsxs(N,{children:[e.jsx(r,{value:"all",children:"Todos"}),e.jsx(r,{value:"0-30",children:"0-30 dias"}),e.jsx(r,{value:"31-60",children:"31-60 dias"}),e.jsx(r,{value:"61-90",children:"61-90 dias"}),e.jsx(r,{value:"90+",children:"90+ dias"})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Buscar"}),e.jsxs("div",{className:"relative",children:[e.jsx($,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(g,{placeholder:"Cliente, email, empresa...",value:t.search,onChange:s=>d(a=>({...a,search:s.target.value})),className:"pl-10"})]})]})]})})]}),e.jsxs(c,{children:[e.jsx(w,{children:e.jsxs(C,{children:["Faturas (",b.length,")"]})}),e.jsx(o,{children:e.jsx("div",{className:"space-y-4",children:b.map(s=>{const a=T(s.status,s.overdue_days);return e.jsx("div",{className:`p-4 border rounded-lg ${s.status==="overdue"?"border-red-200 bg-red-50":""}`,children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"font-semibold",children:s.id}),e.jsxs(S,{variant:a.variant,children:[s.status==="overdue"&&e.jsx(D,{className:"h-3 w-3 mr-1"}),a.label]}),e.jsx(S,{variant:"outline",children:B(s.type)})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(M,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"font-medium",children:s.client_name})]}),s.client_company&&e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(K,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-gray-600",children:s.client_company})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-gray-600",children:s.client_email})]}),s.client_phone&&e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(q,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-gray-600",children:s.client_phone})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 mb-1",children:s.description}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(H,{className:"h-4 w-4 text-gray-400"}),e.jsxs("span",{className:"text-gray-600",children:["Vencimento: ",new Date(s.due_date).toLocaleDateString("pt-BR")]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-2xl font-bold text-green-600 mb-2",children:["R$ ",s.amount.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsxs(h,{size:"sm",onClick:()=>E(s),className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(k,{className:"h-4 w-4 mr-1"}),"Enviar Link"]}),s.checkout_url&&e.jsx(h,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs("a",{href:s.checkout_url,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(X,{className:"h-4 w-4 mr-1"}),"Checkout"]})})]})]})]})]})})},s.id)})})})]}),e.jsx(J,{open:L,onOpenChange:x,children:e.jsxs(U,{className:"max-w-2xl",children:[e.jsx(Z,{children:e.jsx(z,{children:"Enviar Link de Pagamento"})}),e.jsxs("div",{className:"space-y-4",children:[n&&e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Detalhes da Fatura"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Cliente:"})," ",n.client_name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",n.client_email]})]}),e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Valor:"})," R$"," ",n.amount.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Atraso:"})," ",n.overdue_days," dias"]})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Mensagem"}),e.jsx(W,{value:j,onChange:s=>_(s.target.value),rows:8,className:"mt-1"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(h,{onClick:()=>{console.log("Sending payment link:",{invoice:n,message:j}),x(!1)},children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),"Enviar por Email"]}),e.jsxs(h,{variant:"outline",onClick:()=>{console.log("Sending via WhatsApp:",{invoice:n,message:j}),x(!1)},children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Enviar por WhatsApp"]}),e.jsx(h,{variant:"outline",onClick:()=>x(!1),children:"Cancelar"})]})]})]})})]})}export{re as default};
