import{c as ne,r as n,j as e,C as m,a as b,d as y,e as w,g as x,f as g,aM as ee,af as o,ag as j,aU as J,D as se,aZ as ce,a_ as de,a$ as oe,b0 as me,a1 as xe,p as he,T as ue,h as pe,i as M,k as G,A as X,b as Q,S as B,B as z,ai as V,ap as O,b1 as je,E as ge,H as ve,I as fe,J as Ne,K as be,N as Z,ao as K,m as H,b2 as ye,ad as we,v as _e,w as ke,x as Ce,ae as Se,aN as ae,aQ as W,b3 as Ee,aa as Ae}from"./index-D2dOrPZ8.js";import{M as q}from"./map-pin-C1duHusI.js";import{K as re}from"./key-DrOyWj5p.js";import{F as Le}from"./funnel-D8IEwOH8.js";import{S as Pe}from"./square-pen-Bi43ABVd.js";import{U as Ue}from"./user-x-B0vz_ESM.js";const Fe=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],ze=ne("navigation",Fe);function $e({onLocationSelect:t,initialLat:k=-23.5505,initialLng:v=-46.6333}){const[S,s]=n.useState(!1),[i,u]=n.useState(k&&v?{lat:k,lng:v}:null),[L,p]=n.useState(k.toString()),[f,P]=n.useState(v.toString()),_=()=>{if(!navigator.geolocation){alert("Geolocalização não é suportada pelo seu navegador");return}s(!0),navigator.geolocation.getCurrentPosition(async l=>{const c=l.coords.latitude,h=l.coords.longitude;u({lat:c,lng:h}),p(c.toFixed(6)),P(h.toFixed(6));try{const D=(await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${c}&lon=${h}&addressdetails=1`)).json()).display_name||`${c.toFixed(6)}, ${h.toFixed(6)}`;t(c,h,D)}catch(N){console.error("[v0] Error fetching address:",N),t(c,h,`${c.toFixed(6)}, ${h.toFixed(6)}`)}finally{s(!1)}},l=>{console.error("[v0] Geolocation error:",l),alert("Não foi possível obter sua localização"),s(!1)})},E=async()=>{const l=Number.parseFloat(L),c=Number.parseFloat(f);if(isNaN(l)||isNaN(c)){alert("Por favor, insira coordenadas válidas");return}if(l<-90||l>90||c<-180||c>180){alert("Coordenadas fora do intervalo válido");return}s(!0),u({lat:l,lng:c});try{const U=(await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${l}&lon=${c}&addressdetails=1`)).json()).display_name||`${l.toFixed(6)}, ${c.toFixed(6)}`;t(l,c,U)}catch(h){console.error("[v0] Error fetching address:",h),t(l,c,`${l.toFixed(6)}, ${c.toFixed(6)}`)}finally{s(!1)}};return e.jsxs(m,{children:[e.jsxs(b,{children:[e.jsxs(y,{className:"flex items-center space-x-2",children:[e.jsx(q,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{children:"Selecionar Localização"})]}),e.jsx(w,{children:"Use sua localização atual ou insira coordenadas manualmente"})]}),e.jsxs(x,{className:"space-y-4",children:[e.jsx(g,{onClick:_,disabled:S,className:"w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800",children:S?e.jsxs(e.Fragment,{children:[e.jsx(ee,{className:"mr-2 h-4 w-4 animate-spin"}),"Obtendo localização..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ze,{className:"mr-2 h-4 w-4"}),"Usar Minha Localização Atual"]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"h-px flex-1 bg-gray-200 dark:bg-gray-700"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"OU"}),e.jsx("div",{className:"h-px flex-1 bg-gray-200 dark:bg-gray-700"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"latitude",className:"text-xs",children:"Latitude"}),e.jsx(j,{id:"latitude",type:"number",step:"0.000001",value:L,onChange:l=>p(l.target.value),placeholder:"-23.550520",className:"text-sm"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"longitude",className:"text-xs",children:"Longitude"}),e.jsx(j,{id:"longitude",type:"number",step:"0.000001",value:f,onChange:l=>P(l.target.value),placeholder:"-46.633308",className:"text-sm"})]})]}),e.jsxs(g,{onClick:E,disabled:S,variant:"outline",className:"w-full bg-transparent",children:[e.jsx(J,{className:"mr-2 h-4 w-4"}),"Buscar Endereço"]})]}),i&&e.jsx("div",{className:"p-4 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-950/20 dark:to-indigo-950/20 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(q,{className:"h-5 w-5 text-blue-600 mt-0.5"}),e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-blue-900 dark:text-blue-100",children:"Localização Selecionada"}),e.jsxs("p",{className:"text-xs text-blue-700 dark:text-blue-300",children:["Lat: ",i.lat.toFixed(6),", Lng: ",i.lng.toFixed(6)]})]})]})}),i&&e.jsx("div",{className:"rounded-lg overflow-hidden border-2 border-gray-200 dark:border-gray-700",children:e.jsx("iframe",{width:"100%",height:"300",frameBorder:"0",scrolling:"no",src:`https://www.openstreetmap.org/export/embed.html?bbox=${i.lng-.01},${i.lat-.01},${i.lng+.01},${i.lat+.01}&layer=mapnik&marker=${i.lat},${i.lng}`,style:{border:0}})})]})]})}const T={admin:{name:"Administrador",description:"Acesso completo ao sistema",permissions:["view_projects","create_projects","edit_projects","cancel_projects","view_catalog","purchase_services","manage_users","view_payments","manage_payments","approve_deliveries","access_ai_knowledge","edit_ai_knowledge","view_analytics","admin_access"]},financeiro:{name:"Financeiro",description:"Acesso a pagamentos e relatórios financeiros",permissions:["view_projects","view_payments","manage_payments","view_analytics"]},gestor_projetos:{name:"Gestor de Projetos",description:"Gerenciamento completo de projetos",permissions:["view_projects","create_projects","edit_projects","cancel_projects","approve_deliveries","view_analytics"]},visualizador:{name:"Visualizador",description:"Apenas visualização de projetos e catálogo",permissions:["view_projects","view_catalog"]},comprador:{name:"Comprador",description:"Visualização e compra de serviços",permissions:["view_projects","view_catalog","purchase_services"]}};function Re({user:t,open:k,onOpenChange:v,onSave:S}){const[s,i]=n.useState(t),[u,L]=n.useState(!1),[p,f]=n.useState(""),[P,_]=n.useState(!1),[E,l]=n.useState(""),[c,h]=n.useState(!1),[N,U]=n.useState(""),D=a=>{const d=T[a];if(d){if(a==="admin"&&!s.is_admin){U(a),h(!0);return}i({...s,permissions:d.permissions}),f(a)}},r=()=>{const a=T[N];a&&(i({...s,permissions:a.permissions,is_admin:N==="admin"}),f(N)),h(!1),U("")},A=a=>{switch(a){case"empresas":return"Empresa";case"agencias":return"Agência";case"nomades":return"Nômade";case"admin":return"Admin";default:return a}},$=a=>{switch(a){case"company_admin":return"Admin Empresa";case"company_user":return"Usuário Empresa";case"agency_admin":return"Admin Agência";case"agency_user":return"Usuário Agência";case"nomad":return"Nômade";case"admin":return"Administrador";default:return a}},C=a=>{const d=new Date(a);return{date:d.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}),time:d.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}},te=async a=>{const d=a.replace(/\D/g,"");let F=d;if(d.length>5&&(F=`${d.slice(0,5)}-${d.slice(5,8)}`),i({...s,address:{...s.address,cep:F}}),d.length===8){_(!0),l("");try{const R=await(await fetch(`https://viacep.com.br/ws/${d}/json/`)).json();if(R.erro){l("CEP não encontrado"),_(!1);return}i({...s,address:{cep:F,street:R.logradouro||"",number:s.address?.number||"",complement:R.complemento||s.address?.complement||"",neighborhood:R.bairro||"",city:R.localidade||"",state:R.uf||"",latitude:s.address?.latitude,longitude:s.address?.longitude}}),_(!1)}catch(I){console.error("[v0] Error fetching CEP:",I),l("Erro ao buscar CEP"),_(!1)}}},ie=(a,d,F)=>{console.log("[v0] Location selected:",{lat:a,lng:d,address:F}),i({...s,address:{...s.address,latitude:a,longitude:d,cep:s.address?.cep||"",street:s.address?.street||"",number:s.address?.number||"",complement:s.address?.complement||"",neighborhood:s.address?.neighborhood||"",city:s.address?.city||"",state:s.address?.state||""}})},le=()=>{L(!0),S(s),L(!1)};return e.jsx(se,{open:k,onOpenChange:v,children:e.jsxs(ce,{children:[e.jsx(de,{}),e.jsxs(oe,{className:Z("fixed top-0 right-0 z-50 h-screen bg-background w-[800px]","shadow-[rgba(0,0,0,0.2)_-8px_0px_32px_0px,rgba(0,0,0,0.1)_-4px_0px_16px_0px]","data-[state=open]:animate-in data-[state=closed]:animate-out","data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right","data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0","data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-100","duration-300 ease-in-out overflow-hidden flex flex-col"),children:[e.jsxs(me,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none z-10",children:[e.jsx(xe,{className:"h-5 w-5"}),e.jsx("span",{className:"sr-only",children:"Close"})]}),e.jsxs("div",{className:"flex-shrink-0 p-8 pb-4 border-b",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(he,{className:"h-6 w-6 text-blue-600"}),e.jsx("h2",{className:"text-2xl font-bold",children:"Gerenciar Usuário"})]}),e.jsx("p",{className:"text-muted-foreground",children:"Edite as informações e permissões do usuário"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-8 pt-4",children:e.jsxs(ue,{defaultValue:"basic",className:"w-full h-full flex flex-col",children:[e.jsxs(pe,{className:"grid w-full grid-cols-5 flex-shrink-0",children:[e.jsx(M,{value:"basic",children:"Informações"}),e.jsx(M,{value:"address",children:"Endereço"}),e.jsx(M,{value:"permissions",children:"Permissões"}),e.jsx(M,{value:"activity",children:"Atividade"}),e.jsx(M,{value:"usage",children:"Uso"})]}),e.jsxs(G,{value:"basic",className:"space-y-4 mt-4 overflow-y-auto max-h-[50vh]",children:[e.jsx(m,{children:e.jsx(x,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(X,{className:"h-16 w-16",children:e.jsx(Q,{className:"bg-blue-600 text-white text-xl",children:t.name.substring(0,2).toUpperCase()})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h3",{className:"text-xl font-semibold",children:t.name}),t.is_admin&&e.jsx(B,{className:"h-5 w-5 text-blue-600"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(z,{variant:"outline",children:A(t.account_type)}),e.jsx(z,{variant:t.is_active?"default":"destructive",children:t.is_active?"Ativo":"Inativo"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:$(t.role)})]})]})})}),e.jsxs(m,{children:[e.jsxs(b,{children:[e.jsx(y,{children:"Informações Pessoais"}),e.jsx(w,{children:"Dados básicos do usuário"})]}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"name",children:"Nome Completo"}),e.jsx(j,{id:"name",value:s.name,onChange:a=>i({...s,name:a.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"email",children:"Email"}),e.jsx(j,{id:"email",type:"email",value:s.email,onChange:a=>i({...s,email:a.target.value})})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(o,{children:"Status da Conta"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Ativar ou desativar o acesso do usuário"})]}),e.jsx(V,{checked:s.is_active,onCheckedChange:a=>i({...s,is_active:a})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(o,{children:"Privilégios de Admin"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Conceder acesso administrativo"})]}),e.jsx(V,{checked:s.is_admin,onCheckedChange:a=>i({...s,is_admin:a})})]})]})]})]}),e.jsxs(G,{value:"address",className:"space-y-4 mt-4 overflow-y-auto max-h-[50vh]",children:[e.jsxs(m,{className:"border-2 border-blue-200 bg-gradient-to-br from-blue-50 to-cyan-50 dark:from-blue-950/20 dark:to-cyan-950/20",children:[e.jsxs(b,{children:[e.jsxs(y,{className:"flex items-center space-x-2",children:[e.jsx(J,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{children:"Buscar por CEP"})]}),e.jsx(w,{children:"Digite o CEP para preencher automaticamente o endereço"})]}),e.jsx(x,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"cep",children:"CEP"}),e.jsxs("div",{className:"relative",children:[e.jsx(j,{id:"cep",placeholder:"00000-000",maxLength:9,value:s.address?.cep||"",onChange:a=>te(a.target.value),className:E?"border-red-500":""}),P&&e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:e.jsx(ee,{className:"h-4 w-4 animate-spin text-blue-600"})})]}),E&&e.jsx("p",{className:"text-sm text-red-600",children:E}),!E&&s.address?.cep&&e.jsxs("p",{className:"text-sm text-green-600 flex items-center space-x-1",children:[e.jsx(O,{className:"h-4 w-4"}),e.jsx("span",{children:"CEP válido"})]})]})})]}),e.jsxs(m,{children:[e.jsxs(b,{children:[e.jsxs(y,{className:"flex items-center space-x-2",children:[e.jsx(q,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{children:"Endereço Completo"})]}),e.jsx(w,{children:"Informações detalhadas do endereço"})]}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(o,{htmlFor:"street",children:"Rua/Avenida"}),e.jsx(j,{id:"street",value:s.address?.street||"",onChange:a=>i({...s,address:{...s.address,street:a.target.value}})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"number",children:"Número"}),e.jsx(j,{id:"number",value:s.address?.number||"",onChange:a=>i({...s,address:{...s.address,number:a.target.value}})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"complement",children:"Complemento"}),e.jsx(j,{id:"complement",placeholder:"Apto, Bloco, etc.",value:s.address?.complement||"",onChange:a=>i({...s,address:{...s.address,complement:a.target.value}})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"neighborhood",children:"Bairro"}),e.jsx(j,{id:"neighborhood",value:s.address?.neighborhood||"",onChange:a=>i({...s,address:{...s.address,neighborhood:a.target.value}})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(o,{htmlFor:"city",children:"Cidade"}),e.jsx(j,{id:"city",value:s.address?.city||"",onChange:a=>i({...s,address:{...s.address,city:a.target.value}})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"state",children:"Estado"}),e.jsx(j,{id:"state",placeholder:"UF",maxLength:2,value:s.address?.state||"",onChange:a=>i({...s,address:{...s.address,state:a.target.value.toUpperCase()}})})]})]})]})]}),e.jsx($e,{onLocationSelect:ie,initialLat:s.address?.latitude,initialLng:s.address?.longitude})]}),e.jsxs(G,{value:"permissions",className:"space-y-4 mt-4 overflow-y-auto max-h-[50vh]",children:[c&&e.jsxs(m,{className:"border-2 border-orange-200 bg-gradient-to-br from-orange-50 to-red-50 dark:from-orange-950/20 dark:to-red-950/20",children:[e.jsxs(b,{children:[e.jsxs(y,{className:"flex items-center space-x-2 text-orange-700 dark:text-orange-400",children:[e.jsx(B,{className:"h-5 w-5"}),e.jsx("span",{children:"Confirmação de Elevação de Privilégios"})]}),e.jsxs(w,{children:["Você está prestes a elevar este usuário para o perfil de"," ",e.jsx("strong",{children:T[N]?.name})]})]}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-white dark:bg-gray-900 rounded-lg border border-orange-200",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Esta ação concederá as seguintes permissões:"}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:T[N]?.permissions.map(a=>e.jsxs(z,{variant:"secondary",className:"text-xs",children:[e.jsx(O,{className:"h-3 w-3 mr-1 text-green-600"}),a.replace(/_/g," ")]},a))})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(g,{variant:"outline",onClick:()=>{h(!1),U("")},children:"Cancelar"}),e.jsxs(g,{onClick:r,className:"bg-gradient-to-r from-orange-600 to-red-600",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Confirmar Elevação"]})]})]})]}),e.jsxs(m,{className:"border-2 border-blue-200 bg-gradient-to-br from-blue-50 to-purple-50 dark:from-blue-950/20 dark:to-purple-950/20",children:[e.jsxs(b,{children:[e.jsxs(y,{className:"flex items-center space-x-2",children:[e.jsx(je,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{children:"Perfis de Permissão Predefinidos"})]}),e.jsx(w,{children:"Selecione um perfil para aplicar permissões rapidamente e elevar privilégios"})]}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs(ge,{value:p,onValueChange:D,children:[e.jsx(ve,{children:e.jsx(fe,{placeholder:"Selecione um perfil de permissão..."})}),e.jsx(Ne,{children:Object.entries(T).map(([a,d])=>e.jsx(be,{value:a,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:d.name}),e.jsx("span",{className:"text-xs text-muted-foreground",children:d.description})]})},a))})]}),p&&e.jsxs("div",{className:"p-3 bg-white dark:bg-gray-900 rounded-lg border animate-in fade-in-0 slide-in-from-top-2 duration-300",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Permissões incluídas neste perfil:"}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:T[p].permissions.map(a=>e.jsxs(z,{variant:"secondary",className:"text-xs",children:[e.jsx(O,{className:"h-3 w-3 mr-1 text-green-600"}),a.replace(/_/g," ")]},a))})]})]})]}),e.jsxs(m,{children:[e.jsxs(b,{children:[e.jsx(y,{children:"Permissões Personalizadas"}),e.jsx(w,{children:"Ajuste permissões individuais conforme necessário (alterações em tempo real)"})]}),e.jsx(x,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[{key:"view_projects",label:"Visualizar Projetos"},{key:"create_projects",label:"Criar Projetos"},{key:"edit_projects",label:"Editar Projetos"},{key:"cancel_projects",label:"Cancelar Projetos"},{key:"view_catalog",label:"Visualizar Catálogo"},{key:"purchase_services",label:"Comprar Serviços"},{key:"manage_users",label:"Gerenciar Usuários"},{key:"view_payments",label:"Visualizar Pagamentos"},{key:"manage_payments",label:"Gerenciar Pagamentos"},{key:"approve_deliveries",label:"Aprovar Entregas"},{key:"access_ai_knowledge",label:"Acessar IA"},{key:"edit_ai_knowledge",label:"Editar IA"},{key:"view_analytics",label:"Visualizar Analytics"},{key:"admin_access",label:"Acesso Admin"}].map(a=>e.jsxs("div",{className:Z("flex items-center justify-between p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-900 transition-colors",s.permissions.includes(a.key)&&"bg-green-50 dark:bg-green-950/20"),children:[e.jsx(o,{className:"cursor-pointer",children:a.label}),e.jsx(V,{checked:s.permissions.includes(a.key),onCheckedChange:d=>{const F=d?[...s.permissions,a.key]:s.permissions.filter(I=>I!==a.key);i({...s,permissions:F}),f("")}})]},a.key))})})]})]}),e.jsxs(G,{value:"activity",className:"space-y-4 mt-4 overflow-y-auto max-h-[50vh]",children:[e.jsxs(m,{className:"border-2 border-blue-200 bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-950/20 dark:to-indigo-950/20",children:[e.jsxs(b,{children:[e.jsxs(y,{className:"flex items-center space-x-2",children:[e.jsx(K,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{children:"Última Entrada"})]}),e.jsx(w,{children:"Último acesso do usuário ao sistema"})]}),e.jsx(x,{children:e.jsxs("div",{className:"flex items-center space-x-4 p-4 bg-white dark:bg-gray-900 rounded-lg",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"h-12 w-12 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center",children:e.jsx(K,{className:"h-6 w-6 text-blue-600"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Data e Hora do Último Acesso"}),e.jsxs("div",{className:"flex items-center space-x-3 mt-1",children:[e.jsx("p",{className:"text-lg font-semibold",children:t.last_login?C(t.last_login).date:"Nunca acessou"}),t.last_login&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-muted-foreground",children:"às"}),e.jsx("p",{className:"text-lg font-semibold text-blue-600",children:C(t.last_login).time})]})]})]})]})})]}),e.jsxs(m,{children:[e.jsxs(b,{children:[e.jsx(y,{children:"Informações da Conta"}),e.jsx(w,{children:"Dados de criação e última atividade"})]}),e.jsx(x,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(H,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Criado em"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[C(t.created_at).date," às ",C(t.created_at).time]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(H,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Última atualização"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[C(t.updated_at).date," às ",C(t.updated_at).time]})]})]})]})})]})]}),e.jsx(G,{value:"usage",className:"mt-4 overflow-y-auto max-h-[50vh]",children:e.jsx(ye,{})})]})}),e.jsxs("div",{className:"flex-shrink-0 flex justify-end space-x-2 p-8 pt-4 border-t",children:[e.jsx(g,{variant:"outline",onClick:()=>v(!1),children:"Cancelar"}),e.jsxs(g,{onClick:le,disabled:u,children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),u?"Salvando...":"Salvar Alterações"]})]})]})]})})}function Te({user:t,open:k,onOpenChange:v,onReset:S}){const[s,i]=n.useState("email"),[u,L]=n.useState(""),[p,f]=n.useState(!1),P=async()=>{f(!0),setTimeout(()=>{const l=`https://allka.com/reset-password?token=abc123xyz789&user=${t.id}`;L(l),f(!1)},1e3)},_=async()=>{f(!0),setTimeout(()=>{f(!1),S()},1e3)},E=()=>{navigator.clipboard.writeText(u)};return e.jsx(se,{open:k,onOpenChange:v,children:e.jsxs(_e,{className:"max-w-2xl",children:[e.jsxs(ke,{children:[e.jsxs(Ce,{className:"flex items-center space-x-2",children:[e.jsx(re,{className:"h-5 w-5"}),e.jsx("span",{children:"Redefinir Senha"})]}),e.jsx(Se,{children:"Escolha como o usuário receberá as instruções para redefinir a senha"})]}),e.jsx(m,{children:e.jsx(x,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(X,{className:"h-12 w-12",children:e.jsx(Q,{className:"bg-blue-600 text-white",children:t.name.substring(0,2).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:t.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.email})]})]})})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(o,{children:"Método de Redefinição"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(m,{className:`cursor-pointer transition-colors ${s==="email"?"ring-2 ring-blue-600":""}`,onClick:()=>i("email"),children:[e.jsx(b,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ae,{className:"h-5 w-5 text-blue-600"}),e.jsx(y,{className:"text-base",children:"Enviar por Email"})]})}),e.jsx(x,{children:e.jsx(w,{children:"Envia automaticamente um link de redefinição para o email cadastrado do usuário"})})]}),e.jsxs(m,{className:`cursor-pointer transition-colors ${s==="link"?"ring-2 ring-blue-600":""}`,onClick:()=>i("link"),children:[e.jsx(b,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(W,{className:"h-5 w-5 text-green-600"}),e.jsx(y,{className:"text-base",children:"Gerar Link"})]})}),e.jsx(x,{children:e.jsx(w,{children:"Gera um link de redefinição que você pode enviar manualmente para o usuário"})})]})]})]}),s==="email"&&e.jsxs(m,{children:[e.jsxs(b,{children:[e.jsx(y,{className:"text-base",children:"Envio Automático"}),e.jsx(w,{children:"O usuário receberá um email com instruções para redefinir a senha"})]}),e.jsx(x,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Email de Destino"}),e.jsx(j,{value:t.email,disabled:!0})]})})]}),s==="link"&&e.jsxs(m,{children:[e.jsxs(b,{children:[e.jsx(y,{className:"text-base",children:"Link de Redefinição"}),e.jsx(w,{children:"Gere um link único que pode ser enviado manualmente"})]}),e.jsx(x,{className:"space-y-4",children:u?e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Link Gerado"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(j,{value:u,readOnly:!0}),e.jsx(g,{variant:"outline",size:"sm",onClick:E,children:e.jsx(W,{className:"h-4 w-4"})})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Este link expira em 24 horas"})]}):e.jsx(g,{onClick:P,disabled:p,className:"w-full",children:p?"Gerando...":"Gerar Link de Redefinição"})})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4 border-t",children:[e.jsx(g,{variant:"outline",onClick:()=>v(!1),children:"Cancelar"}),s==="email"?e.jsxs(g,{onClick:_,disabled:p,children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),p?"Enviando...":"Enviar Email"]}):e.jsx(g,{onClick:()=>v(!1),disabled:!u,children:"Concluído"})]})]})})}const Y=[{id:1,email:"admin@techcorp.com",name:"Carlos Silva",account_type:"empresas",account_sub_type:"in-house",company_id:1,role:"company_admin",permissions:[],is_admin:!0,is_active:!0,created_at:"2023-06-15",updated_at:"2024-01-20"},{id:2,email:"nomade@allka.com",name:"Ana Santos",account_type:"nomades",account_sub_type:null,role:"nomad",permissions:[],is_admin:!1,is_active:!0,created_at:"2023-07-01",updated_at:"2024-01-15"},{id:3,email:"agency@partner.com",name:"João Costa",account_type:"agencias",account_sub_type:null,agency_id:1,role:"agency_admin",permissions:[],is_admin:!1,is_active:!1,created_at:"2023-08-10",updated_at:"2024-01-10"}];function Oe(){const[t,k]=n.useState([]),[v,S]=n.useState([]),[s,i]=n.useState(""),[u,L]=n.useState("all"),[p,f]=n.useState(null),[P,_]=n.useState(!1),[E,l]=n.useState(!1),[c,h]=n.useState(!0);n.useEffect(()=>{setTimeout(()=>{k(Y),S(Y),h(!1)},1e3)},[]),n.useEffect(()=>{let r=t;s&&(r=r.filter(A=>A.name.toLowerCase().includes(s.toLowerCase())||A.email.toLowerCase().includes(s.toLowerCase()))),u!=="all"&&(r=r.filter(A=>A.account_type===u)),S(r)},[t,s,u]);const N=(r,A)=>{switch(f(r),A){case"edit":_(!0);break;case"password":l(!0);break;case"toggle_status":const $=t.map(C=>C.id===r.id?{...C,is_active:!C.is_active}:C);k($);break}},U=r=>{switch(r){case"empresas":return"Empresa";case"agencias":return"Agência";case"nomades":return"Nômade";case"admin":return"Admin";default:return r}},D=r=>{switch(r){case"company_admin":return"Admin Empresa";case"company_user":return"Usuário Empresa";case"agency_admin":return"Admin Agência";case"agency_user":return"Usuário Agência";case"nomad":return"Nômade";case"admin":return"Administrador";default:return r}};return c?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"container mx-auto pt-6 px-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Gestão de Usuários"}),e.jsx("p",{className:"text-muted-foreground",children:"Gerencie todos os usuários da plataforma"})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs(z,{variant:"outline",className:"text-sm",children:[v.length," usuários"]})})]}),e.jsx(m,{children:e.jsx(x,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(J,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(j,{placeholder:"Buscar por nome ou email...",value:s,onChange:r=>i(r.target.value),className:"pl-10"})]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Le,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("select",{value:u,onChange:r=>L(r.target.value),className:"px-3 py-2 border rounded-md text-sm",children:[e.jsx("option",{value:"all",children:"Todos os tipos"}),e.jsx("option",{value:"empresas",children:"Empresas"}),e.jsx("option",{value:"agencias",children:"Agências"}),e.jsx("option",{value:"nomades",children:"Nômades"}),e.jsx("option",{value:"admin",children:"Administradores"})]})]})]})})}),e.jsx("div",{className:"grid gap-4",children:v.map(r=>e.jsx(m,{children:e.jsx(x,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(X,{className:"h-12 w-12",children:e.jsx(Q,{className:"bg-blue-600 text-white",children:r.name.substring(0,2).toUpperCase()})}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h3",{className:"font-medium",children:r.name}),r.is_admin&&e.jsx(B,{className:"h-4 w-4 text-blue-600"})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-muted-foreground",children:[e.jsx(ae,{className:"h-3 w-3"}),e.jsx("span",{children:r.email})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-muted-foreground",children:[e.jsx(H,{className:"h-3 w-3"}),e.jsxs("span",{children:["Criado em ",new Date(r.created_at).toLocaleDateString()]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"text-right space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(z,{variant:"outline",children:U(r.account_type)}),e.jsx(z,{variant:r.is_active?"default":"destructive",children:r.is_active?"Ativo":"Inativo"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:D(r.role)})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(g,{variant:"outline",size:"sm",onClick:()=>N(r,"edit"),children:e.jsx(Pe,{className:"h-4 w-4"})}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>N(r,"password"),children:e.jsx(re,{className:"h-4 w-4"})}),e.jsx(g,{variant:r.is_active?"destructive":"default",size:"sm",onClick:()=>N(r,"toggle_status"),children:r.is_active?e.jsx(Ue,{className:"h-4 w-4"}):e.jsx(Ae,{className:"h-4 w-4"})})]})]})]})})},r.id))}),p&&e.jsxs(e.Fragment,{children:[e.jsx(Re,{user:p,open:P,onOpenChange:_,onSave:r=>{const A=t.map($=>$.id===r.id?r:$);k(A),_(!1)}}),e.jsx(Te,{user:p,open:E,onOpenChange:l,onReset:()=>{l(!1)}})]})]})}export{Oe as default};
