import{M as F,r as a,bV as u,j as t,P as B,B as L,az as T,Z as M}from"./index-D2dOrPZ8.js";import{D as R}from"./data-table-BARJs-tp.js";import{P as k}from"./project-modal-form-CFanLYa-.js";import{C as z}from"./confirmation-dialog-Bk9N8cdM.js";import{S as _}from"./square-pen-Bi43ABVd.js";import"./table-DSYZvwhV.js";import"./skeleton-D4sfmQAY.js";import"./triangle-alert-Cjhkzg0C.js";const $={planning:"bg-blue-100 text-blue-800",active:"bg-green-100 text-green-800",on_hold:"bg-yellow-100 text-yellow-800",completed:"bg-gray-100 text-gray-800",cancelled:"bg-red-100 text-red-800"},q={planning:"Planejamento",active:"Ativo",on_hold:"Em Espera",completed:"Concluído",cancelled:"Cancelado"};function K(){const{toast:o}=F(),[p,x]=a.useState([]),[h,d]=a.useState(!0),[j,m]=a.useState(null),[f,r]=a.useState(!1),[g,s]=a.useState(),[n,l]=a.useState({open:!1});a.useEffect(()=>{c()},[]);const c=async()=>{try{d(!0),m(null);const e=await u.getProjects();x(e)}catch{const i="Falha ao carregar projetos";m(i),o({title:"Erro",description:i,variant:"destructive"})}finally{d(!1)}},w=()=>{s(void 0),r(!0)},C=e=>{s(e),r(!0)},N=e=>{l({open:!0,project:e})},P=async()=>{const e=n.project;if(e)try{await u.deleteProject(e.id),o({title:"Sucesso",description:"Projeto excluído com sucesso"}),c()}catch{o({title:"Erro",description:"Falha ao excluir projeto",variant:"destructive"})}finally{l({open:!1})}},b=e=>{c()},v=()=>{r(!1),s(void 0)},y=e=>e?new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e):"-",E=e=>e?new Date(e).toLocaleDateString("pt-BR"):"-",D=[{field:"name",headerName:"Nome",width:200,renderCell:e=>t.jsx("div",{className:"font-medium text-sm truncate max-w-[150px] sm:max-w-none",children:e})},{field:"client",headerName:"Cliente",width:150,renderCell:e=>t.jsx("div",{className:"text-sm truncate max-w-[120px] sm:max-w-none",children:e?.name||"-"})},{field:"manager",headerName:"Gerente",width:150,renderCell:e=>t.jsx("div",{className:"text-sm truncate max-w-[120px] sm:max-w-none",children:e?.name||"-"})},{field:"status",headerName:"Status",width:120,renderCell:e=>t.jsx(L,{className:`${$[e]} text-xs`,children:q[e]})},{field:"budget",headerName:"Orçamento",width:120,renderCell:e=>t.jsx("div",{className:"text-sm font-mono",children:y(e)})},{field:"start_date",headerName:"Data de Início",width:120,renderCell:e=>t.jsx("div",{className:"text-sm",children:E(e)})}],S=[{label:"Visualizar",icon:t.jsx(T,{className:"w-4 h-4"}),onClick:e=>{window.location.href=`/projects/${e.id}`},variant:"ghost"},{label:"Editar",icon:t.jsx(_,{className:"w-4 h-4"}),onClick:C,variant:"ghost"},{label:"Excluir",icon:t.jsx(M,{className:"w-4 h-4"}),onClick:N,variant:"ghost"}];return t.jsxs("div",{className:"p-4 sm:p-6",children:[t.jsx(R,{title:"Projetos",columns:D,rows:p,isLoading:h,error:j,actions:S,searchable:!0,searchPlaceholder:"Buscar projetos...",onCreateNew:w,createButtonLabel:t.jsxs(t.Fragment,{children:[t.jsx(B,{className:"w-4 h-4 mr-2"}),"Novo Projeto"]}),emptyMessage:"Nenhum projeto cadastrado",className:"w-full"}),t.jsx(k,{open:f,onClose:v,onSubmit:b,initialData:g}),t.jsx(z,{open:n.open,onClose:()=>l({open:!1}),onConfirm:P,title:"Confirmar Exclusão",message:`Tem certeza que deseja excluir o projeto "${n.project?.name}"? Esta ação não pode ser desfeita.`,confirmText:"Excluir"})]})}export{K as default};
