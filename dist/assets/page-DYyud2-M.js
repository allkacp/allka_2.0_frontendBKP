import{c as T,r,j as e,f as c,q as W,D as L,ax as k,P as O,v as E,w as P,x as A,af as o,ag as h,E as z,H as M,I as V,J as q,z as B,ay as p,a3 as H,y as F,a2 as G,K as R,ai as J,C as v,a as K,d as U,g as y,T as X,h as Y,i as Z,k as $,B as Q,az as ee,Z as se}from"./index-D2dOrPZ8.js";import{E as ae}from"./eye-off-99P7biTF.js";import{S as te}from"./square-pen-Bi43ABVd.js";const ie=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],le=T("chart-pie",ie),g=[{value:"stats",label:"Estatísticas",icon:B},{value:"chart",label:"Gráfico",icon:le},{value:"table",label:"Tabela",icon:p},{value:"activity",label:"Atividades",icon:H},{value:"progress",label:"Progresso",icon:F},{value:"metric",label:"Métrica",icon:G}],b=[{value:"empresas",label:"Empresas"},{value:"agencias",label:"Agências"},{value:"nomades",label:"Nômades"},{value:"admin",label:"Administradores"}];function de(){const[u,x]=r.useState([]),[i,d]=r.useState(null),[f,m]=r.useState(!1),[ne,N]=r.useState(null),[w,j]=r.useState(!0),[l,n]=r.useState({type:"stats",title:"",position:{x:0,y:0,width:4,height:2},config:{},visible:!0,account_types:[],account_levels:[]});r.useEffect(()=>{S()},[]);const S=async()=>{try{j(!0);const a=[{id:"1",account_type:"empresas",widgets:[{id:"w1",type:"stats",title:"Projetos Ativos",position:{x:0,y:0,width:3,height:2},config:{metric:"active_projects",color:"blue"},visible:!0,account_types:["empresas"],created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{id:"w2",type:"chart",title:"Receita Mensal",position:{x:3,y:0,width:6,height:4},config:{chart_type:"line",data_source:"monthly_revenue"},visible:!0,account_types:["empresas"],created_at:new Date().toISOString(),updated_at:new Date().toISOString()}],is_default:!0,created_by:"admin",created_at:new Date().toISOString(),updated_at:new Date().toISOString()}];x(a),d(a[0])}catch(a){console.error("Error loading dashboard layouts:",a)}finally{j(!1)}},C=async()=>{if(!i||!l.title.trim())return;const a={id:`w${Date.now()}`,...l,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},s={...i,widgets:[...i.widgets,a],updated_at:new Date().toISOString()};x(u.map(t=>t.id===i.id?s:t)),d(s),m(!1),n({type:"stats",title:"",position:{x:0,y:0,width:4,height:2},config:{},visible:!0,account_types:[],account_levels:[]})},_=a=>{if(!i)return;const s={...i,widgets:i.widgets.filter(t=>t.id!==a),updated_at:new Date().toISOString()};x(u.map(t=>t.id===i.id?s:t)),d(s)},D=a=>{if(!i)return;const s={...i,widgets:i.widgets.map(t=>t.id===a?{...t,visible:!t.visible}:t),updated_at:new Date().toISOString()};x(u.map(t=>t.id===i.id?s:t)),d(s)};return w?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Configuração de Dashboard"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Configure widgets e layouts para cada tipo de conta"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(c,{variant:"outline",children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),"Configurações Globais"]}),e.jsxs(L,{open:f,onOpenChange:m,children:[e.jsx(k,{asChild:!0,children:e.jsxs(c,{children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Novo Widget"]})}),e.jsxs(E,{className:"max-w-2xl",children:[e.jsx(P,{children:e.jsx(A,{children:"Criar Novo Widget"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"widget-title",children:"Título do Widget"}),e.jsx(h,{id:"widget-title",value:l.title,onChange:a=>n(s=>({...s,title:a.target.value})),placeholder:"Ex: Projetos Ativos"})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"widget-type",children:"Tipo de Widget"}),e.jsxs(z,{value:l.type,onValueChange:a=>n(s=>({...s,type:a})),children:[e.jsx(M,{children:e.jsx(V,{})}),e.jsx(q,{children:g.map(a=>e.jsx(R,{value:a.value,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(a.icon,{className:"h-4 w-4 mr-2"}),a.label]})},a.value))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx(o,{children:"Posição X"}),e.jsx(h,{type:"number",value:l.position.x,onChange:a=>n(s=>({...s,position:{...s.position,x:Number.parseInt(a.target.value)||0}}))})]}),e.jsxs("div",{children:[e.jsx(o,{children:"Posição Y"}),e.jsx(h,{type:"number",value:l.position.y,onChange:a=>n(s=>({...s,position:{...s.position,y:Number.parseInt(a.target.value)||0}}))})]}),e.jsxs("div",{children:[e.jsx(o,{children:"Largura"}),e.jsx(h,{type:"number",value:l.position.width,onChange:a=>n(s=>({...s,position:{...s.position,width:Number.parseInt(a.target.value)||1}}))})]}),e.jsxs("div",{children:[e.jsx(o,{children:"Altura"}),e.jsx(h,{type:"number",value:l.position.height,onChange:a=>n(s=>({...s,position:{...s.position,height:Number.parseInt(a.target.value)||1}}))})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(J,{checked:l.visible,onCheckedChange:a=>n(s=>({...s,visible:a}))}),e.jsx(o,{children:"Widget visível por padrão"})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(c,{variant:"outline",onClick:()=>m(!1),children:"Cancelar"}),e.jsx(c,{onClick:C,children:"Criar Widget"})]})]})]})]})]})]}),e.jsxs(v,{children:[e.jsx(K,{children:e.jsxs(U,{className:"flex items-center",children:[e.jsx(p,{className:"h-5 w-5 mr-2"}),"Layouts por Tipo de Conta"]})}),e.jsx(y,{children:e.jsxs(X,{value:i?.account_type,onValueChange:a=>{const s=u.find(t=>t.account_type===a);d(s||null)},children:[e.jsx(Y,{className:"grid w-full grid-cols-4",children:b.map(a=>e.jsx(Z,{value:a.value,children:a.label},a.value))}),b.map(a=>e.jsx($,{value:a.value,className:"mt-6",children:i&&i.account_type===a.value?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["Widgets para ",a.label]}),e.jsxs(Q,{variant:"outline",children:[i.widgets.length," widgets"]})]}),e.jsxs("div",{className:"grid gap-4",children:[i.widgets.map(s=>e.jsx(v,{className:s.visible?"":"opacity-50",children:e.jsx(y,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[g.find(t=>t.value===s.type)?.icon&&e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:(()=>{const t=g.find(I=>I.value===s.type)?.icon;return t?e.jsx(t,{className:"h-4 w-4 text-blue-600"}):null})()}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:s.title}),e.jsxs("p",{className:"text-sm text-gray-600",children:[g.find(t=>t.value===s.type)?.label," • Posição:"," ",s.position.x,",",s.position.y," • Tamanho: ",s.position.width,"x",s.position.height]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>D(s.id),children:s.visible?e.jsx(ee,{className:"h-4 w-4"}):e.jsx(ae,{className:"h-4 w-4"})}),e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>N(s),children:e.jsx(te,{className:"h-4 w-4"})}),e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>_(s.id),children:e.jsx(se,{className:"h-4 w-4"})})]})]})})},s.id)),i.widgets.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(p,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Nenhum widget configurado para este tipo de conta"}),e.jsx("p",{className:"text-sm",children:'Clique em "Novo Widget" para começar'})]})]})]}):e.jsx("div",{className:"text-center py-8 text-gray-500",children:e.jsxs("p",{children:["Layout não encontrado para ",a.label]})})},a.value))]})})]})]})}export{de as default};
